%% Writes the antenna gain data to a CSV file

clc
clear all
close all

f = (0.5:0.1:4.8) * 1e9;
S21 = -1 * [                                                  ...
 61.45 61.52 65.09 59.84 73.38 62.55 57.88 47.94 60.34 44.95  ...
 58.47 60.39 49.44 43.96                                      ...
 44.31 35.04 33.87 34.74 51.59 34.59 32.10 28.94 31.14 35.55  ...
 38.01 40.95 44.45 41.42 33.90                                ...
 31.36 35.73 39.79 41.24 41.48 40.77 34.04 34.79 44.87 48.41  ...
 41.40 39.36 39.60 37.98 38.20                                ...
];

c = 3e8;
lambda = c./f;
d = 1.815;

G = 10.^((S21-20*log10(lambda./(4*pi*d)))./20);
G_dB = 10*log10(G);

dlmwrite('Antenna_Gains.csv', G_dB, ',');